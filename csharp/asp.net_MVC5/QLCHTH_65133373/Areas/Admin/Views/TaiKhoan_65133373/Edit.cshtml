@model QLCHTH_65133373.Models.ViewModels.TaiKhoanViewModel
@{
    ViewBag.Title = "Chỉnh sửa tài khoản";
}

<h1 class="mt-4"><i class="fas fa-user-edit me-2"></i>Chỉnh sửa tài khoản</h1>
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item"><a href="@Url.Action("Index", "Dashboard_65133373")">Dashboard</a></li>
    <li class="breadcrumb-item"><a href="@Url.Action("Index")">Tài khoản</a></li>
    <li class="breadcrumb-item active">Chỉnh sửa</li>
</ol>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.MaTK)
    
    <div class="card mb-4">
        <div class="card-header"><i class="fas fa-user me-1"></i>Thông tin tài khoản - Mã: <strong>@Model.MaTK</strong></div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Tên đăng nhập</label>
                        @Html.TextBoxFor(m => m.TenDangNhap, new { @class = "form-control", @readonly = "readonly" })
                        <small class="text-muted">Tên đăng nhập không thể thay đổi</small>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Tên hiển thị <span class="text-danger">*</span></label>
                        @Html.TextBoxFor(m => m.TenHienThi, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.TenHienThi, "", new { @class = "text-danger small" })
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Ghi chú</label>
                        @Html.TextAreaFor(m => m.GhiChu, new { @class = "form-control", rows = "2" })
                        @Html.ValidationMessageFor(m => m.GhiChu, "", new { @class = "text-danger small" })
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Loại tài khoản <span class="text-danger">*</span></label>
                        @Html.DropDownListFor(m => m.LoaiTaiKhoan,
                            new List<SelectListItem> {
                                new SelectListItem { Value = "0", Text = "Quản trị viên" },
                                new SelectListItem { Value = "1", Text = "Thu ngân" }
                            },
                            new { @class = "form-select" })
                        @Html.ValidationMessageFor(m => m.LoaiTaiKhoan, "", new { @class = "text-danger small" })
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header bg-info text-white"><i class="fas fa-key me-1"></i>Đổi mật khẩu (tùy chọn)</div>
        <div class="card-body">
            <div class="alert alert-info mb-3">
                <i class="fas fa-info-circle me-1"></i>
                Để trống nếu không muốn thay đổi mật khẩu. Nếu muốn đổi, nhập mật khẩu mới (tối thiểu 3 ký tự).
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Mật khẩu mới</label>
                        @Html.PasswordFor(m => m.MatKhau, new { @class = "form-control", placeholder = "Nhập mật khẩu mới (nếu muốn đổi)" })
                        @Html.ValidationMessageFor(m => m.MatKhau, "", new { @class = "text-danger small" })
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label class="form-label">Xác nhận mật khẩu mới</label>
                        @Html.PasswordFor(m => m.XacNhanMatKhau, new { @class = "form-control", placeholder = "Nhập lại mật khẩu mới" })
                        @Html.ValidationMessageFor(m => m.XacNhanMatKhau, "", new { @class = "text-danger small" })
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex justify-content-between mb-4">
        <a href="@Url.Action("Index")" class="btn btn-secondary"><i class="fas fa-arrow-left me-1"></i>Quay lại</a>
        <button type="submit" class="btn btn-primary"><i class="fas fa-save me-1"></i>Cập nhật</button>
    </div>
}

<div class="card mb-4">
    <div class="card-header bg-warning text-dark"><i class="fas fa-redo me-1"></i>Reset mật khẩu về mặc định</div>
    <div class="card-body">
        <p class="mb-2">Đặt lại mật khẩu về giá trị mặc định:</p>
        <ul class="mb-3">
            <li>Tài khoản <strong>Quản trị viên</strong>: mật khẩu mặc định là <code>admin</code></li>
            <li>Tài khoản <strong>Thu ngân</strong>: mật khẩu mặc định là <code>123</code></li>
        </ul>
        <a href="@Url.Action("ResetPassword", new { id = Model.MaTK })" class="btn btn-warning">
            <i class="fas fa-redo me-1"></i>Reset mật khẩu về mặc định
        </a>
    </div>
</div>
